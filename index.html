<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>iRacing ìŠ¤í¬ì¸ ì¹´ ì„±í–¥ ì„¤ë¬¸ + ì´ìƒí˜• ì›”ë“œì»µ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #020617;
      color: #e5e7eb;
      display: flex;
      justify-content: center;
      min-height: 100vh;
    }
    .app {
      width: 100%;
      max-width: 1080px;
      padding: 24px 16px 40px;
    }
    h1 {
      font-size: 28px;
      margin: 0 0 8px;
      text-align: center;
    }
    .subtitle {
      text-align: center;
      font-size: 14px;
      color: #9ca3af;
      margin-bottom: 24px;
    }
    .steps-nav {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 24px;
      flex-wrap: wrap;
    }
    .step-pill {
      padding: 6px 12px;
      border-radius: 999px;
      border: 1px solid #1f2937;
      font-size: 12px;
      display: flex;
      align-items: center;
      gap: 6px;
      opacity: 0.45;
    }
    .step-pill.active {
      background: #1d4ed8;
      border-color: #2563eb;
      opacity: 1;
    }
    .step-pill.done {
      background: #16a34a;
      border-color: #16a34a;
      opacity: 1;
    }
    .step-pill span.idx {
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: rgba(15,23,42,0.6);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
    }

    .step {
      display: none;
    }
    .step.active {
      display: block;
    }

    /* STEP 1 - ë¼ì´ì„¼ìŠ¤ ì„±í–¥ */
    .license-grid {
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 12px;
    }
    @media (max-width: 900px) {
      .license-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }
    @media (max-width: 640px) {
      .license-grid {
        grid-template-columns: 1fr;
      }
    }
    .license-card {
      background: #020617;
      border-radius: 16px;
      padding: 16px;
      border: 1px solid #1f2937;
      cursor: pointer;
      transition: transform 0.12s ease, box-shadow 0.12s ease, border-color 0.12s ease, background 0.12s ease;
    }
    .license-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.6);
      border-color: #4b5563;
    }
    .license-card.selected {
      border-color: #2563eb;
      background: radial-gradient(circle at top left, rgba(37,99,235,0.35), #020617);
      box-shadow: 0 0 0 1px rgba(37,99,235,0.7);
    }
    .license-badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 28px;
      height: 28px;
      border-radius: 999px;
      background: #111827;
      border: 1px solid #1f2937;
      font-weight: 700;
      font-size: 14px;
      margin-bottom: 6px;
    }
    .license-title {
      font-size: 16px;
      font-weight: 700;
      margin-bottom: 4px;
    }
    .license-desc {
      font-size: 13px;
      color: #9ca3af;
      margin-bottom: 8px;
      line-height: 1.4;
    }
    .license-meta {
      font-size: 11px;
      color: #6b7280;
    }

    .step-footer {
      margin-top: 20px;
      display: flex;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
    }
    button {
      border: none;
      border-radius: 999px;
      padding: 10px 18px;
      font-size: 14px;
      cursor: pointer;
      transition: background 0.12s ease, transform 0.08s ease;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    button.primary {
      background: #1d4ed8;
      color: white;
    }
    button.primary:hover {
      background: #2563eb;
      transform: translateY(-1px);
    }
    button.secondary {
      background: #111827;
      color: #e5e7eb;
    }
    button.secondary:hover {
      background: #1f2937;
      transform: translateY(-1px);
    }
    button:disabled {
      opacity: 0.4;
      cursor: default;
      transform: none;
    }

    .hint {
      font-size: 12px;
      color: #6b7280;
      margin-top: 8px;
    }

    /* STEP 2 - ì´ìƒí˜• ì›”ë“œì»µ */
    .round-info {
      text-align: center;
      margin-bottom: 12px;
      font-size: 14px;
    }
    .match-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 16px;
      margin-top: 8px;
    }
    @media (max-width: 768px) {
      .match-grid {
        grid-template-columns: 1fr;
      }
    }
    .car-card {
      background: #020617;
      border-radius: 16px;
      border: 1px solid #1f2937;
      overflow: hidden;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      height: 100%;
      transition: transform 0.12s ease, box-shadow 0.12s ease, border-color 0.12s ease;
    }
    .car-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.6);
      border-color: #4b5563;
    }
    .car-image-wrap {
      position: relative;
      padding-top: 56.25%;
      overflow: hidden;
      background: #020617;
    }
    .car-image-wrap img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .car-content {
      padding: 12px 14px 14px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      flex: 1;
    }
    .car-name {
      font-size: 15px;
      font-weight: 700;
    }
    .car-class {
      font-size: 12px;
      color: #9ca3af;
    }
    .car-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 6px;
    }
    .tag {
      font-size: 10px;
      border-radius: 999px;
      padding: 2px 8px;
      background: #0b1120;
      border: 1px solid #1f2937;
      color: #9ca3af;
    }
    .step-label {
      font-size: 14px;
      margin-bottom: 6px;
      color: #9ca3af;
    }

    .round-progress {
      font-size: 12px;
      color: #6b7280;
      text-align: center;
      margin-top: 6px;
    }

    /* STEP 3 - ê²°ê³¼ & ê³µìœ  */
    .result-layout {
      display: grid;
      grid-template-columns: minmax(0, 2fr) minmax(0, 1.6fr);
      gap: 16px;
    }
    @media (max-width: 960px) {
      .result-layout {
        grid-template-columns: 1fr;
      }
    }
    .panel {
      background: #020617;
      border-radius: 16px;
      border: 1px solid #1f2937;
      padding: 14px 16px 16px;
    }
    .panel-title {
      font-size: 14px;
      font-weight: 700;
      margin-bottom: 8px;
    }
    .panel-body {
      font-size: 13px;
      color: #9ca3af;
    }
    .summary-line {
      margin-bottom: 6px;
    }
    .cost-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
      margin-top: 6px;
    }
    .cost-table th,
    .cost-table td {
      padding: 4px 6px;
      border-bottom: 1px solid #111827;
    }
    .cost-table th {
      text-align: left;
      color: #e5e7eb;
      font-weight: 600;
    }
    .cost-table td.num {
      text-align: right;
      font-variant-numeric: tabular-nums;
    }
    .winner-highlight {
      border: 1px solid #facc15;
      box-shadow: 0 0 0 1px rgba(250,204,21,0.3);
    }
    .winner-badge {
      font-size: 11px;
      background: rgba(250,204,21,0.1);
      border-radius: 999px;
      padding: 2px 8px;
      border: 1px solid rgba(250,204,21,0.4);
      display: inline-flex;
      align-items: center;
      gap: 4px;
      margin-bottom: 4px;
      color: #facc15;
    }

    .share-box {
      margin-top: 6px;
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }
    .share-input {
      flex: 1;
      min-width: 0;
      border-radius: 999px;
      border: 1px solid #1f2937;
      background: #020617;
      padding: 8px 10px;
      font-size: 12px;
      color: #e5e7eb;
    }
    .share-note {
      font-size: 11px;
      color: #6b7280;
      margin-top: 4px;
    }
    .pill {
      display: inline-flex;
      align-items: center;
      border-radius: 999px;
      padding: 2px 8px;
      border: 1px solid #1f2937;
      font-size: 11px;
      color: #9ca3af;
      gap: 4px;
    }
    .shared-banner {
      margin-bottom: 12px;
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 12px;
      background: rgba(37,99,235,0.08);
      border: 1px solid rgba(37,99,235,0.3);
      color: #bfdbfe;
    }
    .small {
      font-size: 11px;
      color: #6b7280;
    }
  </style>
</head>
<body>
  <div class="app">
    <h1>iRacing ìŠ¤í¬ì¸ ì¹´ ì„±í–¥ ì„¤ë¬¸ & ì´ìƒí˜• ì›”ë“œì»µ</h1>
    <div class="subtitle">
      ë ˆì´ìŠ¤ ì„±í–¥ &gt; ìŠ¤í¬ì¸ ì¹´ ì´ìƒí˜• ì›”ë“œì»µ &gt; 2025 Season 4 Bí´ë˜ìŠ¤ ìœ ë£Œ ë¹„ìš©ê¹Œì§€ í•œ ë²ˆì— ë³´ê¸°
    </div>

    <div id="sharedBanner" class="shared-banner" style="display:none;"></div>

    <div class="steps-nav">
      <div class="step-pill active" id="navStep1">
        <span class="idx">1</span> ì„±í–¥ / ë¼ì´ì„¼ìŠ¤
      </div>
      <div class="step-pill" id="navStep2">
        <span class="idx">2</span> ì´ìƒí˜• ì›”ë“œì»µ
      </div>
      <div class="step-pill" id="navStep3">
        <span class="idx">3</span> ê²°ê³¼ &amp; ìœ ë£Œ ë¹„ìš©
      </div>
    </div>

    <!-- STEP 1: ë¼ì´ì„¼ìŠ¤ / ì„±í–¥ ì„ íƒ -->
    <div class="step active" id="step1">
      <div class="step-label">Q1. ë‚´ ë ˆì´ìŠ¤ ì„±í–¥ì— ê°€ì¥ ê°€ê¹Œìš´ ë¼ì´ì„¼ìŠ¤ ëŠë‚Œì€?</div>
      <div class="license-grid" id="licenseGrid"></div>
      <div class="hint">
        â€» AëŠ” ì  í‹€ë§¨ ë¦¬ê·¸, DëŠ” ì‚¬ì‹¤ìƒ ë²”í¼ì¹´â€¦ ëŠë‚Œìœ¼ë¡œ ìƒê°í•˜ë©´ ëœë‹¤. í•˜ë‚˜ë§Œ ê³¨ë¼ì„œ ë‹¤ìŒ ë‹¨ê³„ë¡œ!
      </div>
      <div class="step-footer">
        <div></div>
        <button id="toStep2" class="primary" disabled>
          ë‹¤ìŒ ë‹¨ê³„ (ì´ìƒí˜• ì›”ë“œì»µ) â†’
        </button>
      </div>
    </div>

    <!-- STEP 2: ì´ìƒí˜• ì›”ë“œì»µ -->
    <div class="step" id="step2">
      <div class="step-label">Q2. ë‚´ ìŠ¤íƒ€ì¼ì— ê°€ì¥ ì˜ ë§ëŠ” ìŠ¤í¬ì¸ ì¹´ëŠ”?</div>
      <div class="round-info" id="roundInfo"></div>
      <div class="match-grid" id="matchGrid"></div>
      <div class="round-progress" id="roundProgress"></div>

      <div class="step-footer">
        <button id="backTo1" class="secondary">â† 1ë‹¨ê³„ë¡œ ëŒì•„ê°€ê¸°</button>
        <button id="skipToResult" class="secondary">ì›”ë“œì»µ ê±´ë„ˆë›°ê³  ê²°ê³¼ë§Œ ë³´ê¸°</button>
      </div>
      <div class="hint">
        â€» ê°™ì€ ë¼ìš´ë“œ í•œ ë§¤ì¹˜ì—…ì—ì„œ **ì¢Œ/ìš°ì— ê°™ì€ ì°¨ëŸ‰ì´ ë‚˜ì˜¤ì§€ ì•Šë„ë¡** ê³ ì •ëœ ëŒ€ì§„í‘œ(1:1 í† ë„ˆë¨¼íŠ¸)ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤.
      </div>
    </div>

    <!-- STEP 3: ê²°ê³¼ + ìœ ë£Œ ë¹„ìš© + ê³µìœ  ë§í¬ -->
    <div class="step" id="step3">
      <div class="step-label">Q3. ë‚´ ì„±í–¥ / ì´ìƒí˜• / Bí´ë˜ìŠ¤ ìœ ë£Œ ë¹„ìš© ìš”ì•½</div>

      <div class="result-layout">
        <!-- ì¢Œì¸¡: ì„±í–¥ + ì›”ë“œì»µ ê²°ê³¼ -->
        <div class="panel">
          <div class="panel-title">â‘  ë ˆì´ìŠ¤ ì„±í–¥ & ë¼ì´ì„¼ìŠ¤ ëŠë‚Œ</div>
          <div class="panel-body" id="licenseResultBody">
            <!-- filled by JS -->
          </div>

          <hr style="border:0;border-top:1px solid #111827;margin:12px 0;" />

          <div class="panel-title">â‘¡ ìŠ¤í¬ì¸ ì¹´ ì´ìƒí˜• ì›”ë“œì»µ ê²°ê³¼</div>
          <div class="panel-body" id="worldcupResultBody">
            <!-- filled by JS -->
          </div>
        </div>

        <!-- ìš°ì¸¡: ë¹„ìš© + ê³µìœ  -->
        <div class="panel">
          <div class="panel-title">â‘¢ 2025 Season 4 Bí´ë˜ìŠ¤ ìœ ë£Œ ê¸°ì¤€ ë¹„ìš© (ëŒ€ëµ)</div>
          <div class="panel-body" id="costResultBody">
            <!-- filled by JS -->
          </div>

          <hr style="border:0;border-top:1px solid #111827;margin:12px 0;" />

          <div class="panel-title">ê²°ê³¼ ê³µìœ  ë§í¬</div>
          <div class="panel-body">
            <div class="summary-line small">
              ì´ ì„¤ë¬¸/ì›”ë“œì»µ ê²°ê³¼ë¥¼ ë‹¤ë¥¸ ì‚¬ëŒì—ê²Œ ë³´ì—¬ì£¼ê³  ì‹¶ë‹¤ë©´, ì•„ë˜ URLì„ ë³µì‚¬í•´ì„œ ë³´ë‚´ë©´ ëœë‹¤.
            </div>
            <div class="share-box">
              <input id="shareInput" class="share-input" readonly value="" />
              <button id="copyShare" class="secondary" type="button">ë³µì‚¬</button>
            </div>
            <div class="share-note">
              ìƒëŒ€ë°©ì€ ì´ ë§í¬ë¡œ ì ‘ì†í•˜ë©´, ì„¤ë¬¸/ì›”ë“œì»µì„ ë‹¤ì‹œ í•  í•„ìš” ì—†ì´ ë°”ë¡œ <strong>ë‹¹ì‹ ì˜ ê²°ê³¼ í™”ë©´</strong>ì„ ë³´ê²Œ ëœë‹¤.
            </div>
          </div>
        </div>
      </div>

      <div class="step-footer" style="margin-top:20px;">
        <button id="restartAll" class="secondary">ì²˜ìŒë¶€í„° ë‹¤ì‹œ í•˜ê¸°</button>
        <button id="backTo2" class="secondary">â† ì›”ë“œì»µ ë‹¤ì‹œ í•´ë³´ê¸°</button>
      </div>
    </div>
  </div>

  <script>
    // ===============================
    // 0. ìœ í‹¸: ìˆ«ì í¬ë§· / ì¸ì½”ë”©
    // ===============================
    function formatMoney(num) {
      return "$" + num.toFixed(2);
    }

    function encodeResult(obj) {
      const json = JSON.stringify(obj);
      // UTF-8 ì•ˆì „í•˜ê²Œ
      return btoa(encodeURIComponent(json));
    }

    function decodeResult(str) {
      try {
        const json = decodeURIComponent(atob(str));
        return JSON.parse(json);
      } catch (e) {
        console.error("decodeResult error", e);
        return null;
      }
    }

    // ===============================
    // 1. ë¼ì´ì„¼ìŠ¤ ì˜µì…˜ ì •ì˜
    // ===============================
    const licenseOptions = [
      {
        id: "A",
        title: "A ë¼ì´ì„¼ìŠ¤ â€“ ì  í‹€ë§¨ ë¦¬ê·¸",
        desc: "í´ë¦° ë ˆì´ìŠ¤ ìµœìš°ì„ . ì ‘ì´‰ ìµœì†Œí™”, ë¡±ëŸ° í˜ì´ìŠ¤ì™€ íƒ€ì´ì–´ ê´€ë¦¬, ë§¤ë„ˆ ìˆëŠ” ë°°í‹€ì„ ì¦ê¸°ëŠ” íƒ€ì….",
        detail: "ì‹¤ì œ ëª¨í„°ìŠ¤í¬ì¸  ì  í‹€ë§¨ ë“œë¼ì´ë²„ ëŠë‚Œ. ì¸ì‹œë˜íŠ¸ë¥¼ ê·¹ë„ë¡œ ì‹«ì–´í•˜ê³ , ë¬´ë¦¬í•œ ì¶”ì›”ë³´ë‹¤ ê¹¨ë—í•œ ì™„ì£¼ë¥¼ ì„ í˜¸."
      },
      {
        id: "B",
        title: "B ë¼ì´ì„¼ìŠ¤ â€“ ì¹˜ì—´í•œ ìƒì¡´ ê²½ìŸ",
        desc: "ê·¸ë¦¬ë“œ ì „ì²´ê°€ ëŠ‘ëŒ€ ìš°ë¦¬. í˜ì´ìŠ¤ì™€ ë°°í‹€ ëª¨ë‘ ì¹˜ì—´í•œ í™˜ê²½ì—ì„œ ì‚´ì•„ë‚¨ëŠ” ìƒì¡´ ê²½ìŸí˜•.",
        detail: "ì ë‹¹í•œ ë¦¬ìŠ¤í¬ëŠ” ê°ìˆ˜í•˜ë©´ì„œë„ ì™„ì£¼ëŠ” ì±™ê¸°ê³  ì‹¶ì€ íƒ€ì…. iRatingê³¼ ì±”í”¼ì–¸ì‹­ í¬ì¸íŠ¸ ë‘˜ ë‹¤ ìš•ì‹¬ë‚˜ëŠ” êµ¬ê°„."
      },
      {
        id: "C",
        title: "C ë¼ì´ì„¼ìŠ¤ â€“ ì „ì† ê°ì˜¤ ì½”ë„ˆ ì‚¬ë°”ì‚¬",
        desc: "íŠ¹ì • ì½”ë„ˆëŠ” â€˜ì˜¤ëŠ˜ì€ ì—¬ê¸°ì„œ ëˆ„ê°€ ì‚´ì•„ë‚¨ë‚˜â€™ ìˆ˜ì¤€. ë¸Œë ˆì´í‚¹ ì¡´ê³¼ ì‚¬ì´ë“œ ë°”ì´ ì‚¬ì´ë“œê°€ í•­ìƒ ë„ë°•ì¸ êµ¬ê°„.",
        detail: "SR ê´€ë¦¬ë³´ë‹¨ ë°°í‹€ì˜ ì¾Œê°ì´ ë¨¼ì €. ë¬´ë¦¬í•œ dive bombê³¼ ê³¼ê°í•œ ë¼ì¸ ì„ íƒì´ ìì£¼ ë‚˜ì˜¤ëŠ” íŠ¹ìœ ì˜ ì¹´ chaos ë¶„ìœ„ê¸°."
      },
      {
        id: "D",
        title: "D ë¼ì´ì„¼ìŠ¤ â€“ ë²”í¼ì¹´ êµ¬ê°„",
        desc: "ìŠ¤íƒ€íŠ¸ë¶€í„° Turn 1ì€ ì‚¬ì‹¤ìƒ ë²”í¼ì¹´. ë¼ì¸, ë¸Œë ˆì´í‚¹ í¬ì¸íŠ¸ë³´ë‹¤ â€˜ì—¬ê¸°ì„œ ì•ˆ ì£½ëŠ” ë²•â€™ì„ ë¨¼ì € ë°°ì›Œì•¼ í•˜ëŠ” ë ˆë²¨.",
        detail: "ì²« ë© ìƒì¡´ì´ ê³§ ìŠ¤í‚¬. ì •ì‹ ì—†ëŠ” í˜¼ëˆ ì†ì—ì„œ ì°¨ë¥¼ ì„¸ìš°ì§€ ì•Šê³  ì™„ì£¼ë§Œ í•´ë„ ì˜ì›…ì¸ êµ¬ê°„."
      }
    ];

    // ===============================
    // 2. ì°¨ëŸ‰ DB (ì´ë¯¸ ì¤€ë¹„ëœ baseCars ì‚¬ìš©)
    // ===============================
   const baseCars = [
  // =========================
  // í˜„ëŒ€ GT3 ë¼ì¸ì—…
  // =========================
  {
    name: "Aston Martin Vantage GT3 EVO",
    cls: "GT3",
    tags: ["gt3", "modern", "balanced", "stable", "endurance", "meta_candidate"],
    img: "https://s100.iracing.com/wp-content/uploads/2025/09/AstonMartinVantageEVOGT3-feature-350x197.jpg"
  },
  {
    name: "Acura NSX GT3 EVO 22",
    cls: "GT3",
    tags: ["gt3", "modern", "mid_engine", "rotation", "trail_brake", "technical"],
    img: "https://s100.iracing.com/wp-content/uploads/2024/12/acura-nsx-gt3-evo22-feature-350x197.jpg"
  },
  {
    name: "Audi R8 LMS EVO II GT3",
    cls: "GT3",
    tags: ["gt3", "modern", "mid_engine", "agile", "rotation", "audi_fan"],
    img: "https://s100.iracing.com/wp-content/uploads/2023/12/Audi-R8-LMS-EVO-II-GT3_feature-350x197.jpg"
  },
  {
    name: "BMW M4 GT3 EVO",
    cls: "GT3",
    tags: ["gt3", "modern", "front_engine", "stable", "user_friendly", "popular"],
    img: "https://s100.iracing.com/wp-content/uploads/2020/12/BMW-M4-GT3-Evo-feature-350x197.jpg"
  },
  {
    name: "Chevrolet Corvette Z06 GT3.R",
    cls: "GT3",
    tags: ["gt3", "modern", "front_engine", "torque", "aggressive", "american"],
    img: "https://s100.iracing.com/wp-content/uploads/2024/05/chevrolet-corvette-z06-gt3r-feature-350x197.jpg"
  },
  {
    name: "Ferrari 296 GT3",
    cls: "GT3",
    tags: ["gt3", "modern", "mid_engine", "high_downforce", "sharp_turn_in", "meta"],
    img: "https://s100.iracing.com/wp-content/uploads/2023/09/Ferrari296GT3-feature-1-350x197.jpg"
  },
  {
    name: "Ford Mustang GT3",
    cls: "GT3",
    tags: ["gt3", "modern", "front_engine", "torquey", "brutal", "american_muscle"],
    img: "https://s100.iracing.com/wp-content/uploads/2024/05/ford-mustang-gt3-feature-350x197.jpg"
  },
  {
    name: "Lamborghini Huracan GT3 EVO",
    cls: "GT3",
    tags: ["gt3", "modern", "mid_engine", "oversteer_prone", "high_skill", "flashy"],
    img: "https://s100.iracing.com/wp-content/uploads/2020/12/LamborghiniHuracanGT3EVO-350x197.jpg"
  },
  {
    name: "McLaren 720S GT3 EVO",
    cls: "GT3",
    tags: ["gt3", "modern", "mid_engine", "aero_sensitive", "quick", "high_ceiling"],
    img: "https://s100.iracing.com/wp-content/uploads/2024/09/mclaren-720s-gt3-evo-350x197.jpg"
  },
  {
    name: "Mercedes-AMG GT3 2020",
    cls: "GT3",
    tags: ["gt3", "modern", "front_mid_engine", "stable", "braking_confidence", "endurance_favorite"],
    img: "https://s100.iracing.com/wp-content/uploads/2022/05/Mercedes-AMG-GT3-2020-350x197.jpg"
  },
  {
    name: "Porsche 911 GT3 R (992)",
    cls: "GT3",
    tags: ["gt3", "modern", "rear_engine", "rotation", "trail_brake", "high_skill"],
    img: "https://s100.iracing.com/wp-content/uploads/2023/06/porsche992rgt3-feature-1-350x197.jpg"
  },

  // ë ˆê±°ì‹œ / êµ¬í˜• GT3
  {
    name: "Ferrari 488 GT3",
    cls: "GT3",
    tags: ["gt3", "legacy", "mid_engine", "smooth", "classic", "forgiving"],
    img: "https://s100.iracing.com/wp-content/uploads/2017/09/Ferrari-488-GT3-2-350x197.jpg"
  },
  {
    name: "McLaren MP4-12C GT3",
    cls: "GT3",
    tags: ["gt3", "legacy", "mid_engine", "snap_oversteer", "old_school", "challenging"],
    img: "https://s100.iracing.com/wp-content/uploads/2012/11/McLaren-MP4-12C-350x197.jpg"
  },
  {
    name: "BMW Z4 GT3",
    cls: "GT3",
    tags: ["gt3", "legacy", "front_mid_engine", "balanced", "nostalgic", "endurance"],
    img: "https://s100.iracing.com/wp-content/uploads/2013/12/BMW-Z4-GT3-1-350x197.jpg"
  },
  {
    name: "Ford GT-R",
    cls: "GT3",
    tags: ["gt3", "legacy", "mid_engine", "raw", "old_school", "high_skill"],
    img: "https://s100.iracing.com/wp-content/uploads/2012/11/Ford-GTR-350x197.jpg"
  },
  {
    name: "Audi R8 LMS GT3",
    cls: "GT3",
    tags: ["gt3", "legacy", "mid_engine", "lively_rear", "rotation", "sound_enjoyer"],
    img: "https://s100.iracing.com/wp-content/uploads/2016/02/Audi-R8-LMS-GT3-350x197.jpg"
  },
  {
    name: "Ferrari 488 GT3 Evo 2020",
    cls: "GT3",
    tags: ["gt3", "legacy", "mid_engine", "meta_memory", "endurance", "user_friendly"],
    img: "https://s100.iracing.com/wp-content/uploads/2021/09/Ferrari-488-GT3-EVO-350x197.jpg"
  },
  {
    name: "Mercedes-AMG GT3",
    cls: "GT3",
    tags: ["gt3", "legacy", "front_mid_engine", "safe", "rookie_friendly", "endurance"],
    img: "https://s100.iracing.com/wp-content/uploads/2016/02/Mercedes-AMG-GT3-Legacy-350x197.jpg"
  },
  {
    name: "Porsche 911 GT3 R",
    cls: "GT3",
    tags: ["gt3", "legacy", "rear_engine", "rotation", "trail_brake", "purist"],
    img: "https://s100.iracing.com/wp-content/uploads/2021/06/Porsche-911-GT3-R-1-350x197.jpg"
  },

  // =========================
  // GT4 & ì»µ / ì±Œë¦°ì§€
  // =========================
  {
    name: "Ford Mustang GT4",
    cls: "GT4",
    tags: ["gt4", "front_engine", "torquey", "muscle", "forgiving", "aggressive_style"],
    img: "https://s100.iracing.com/wp-content/uploads/2025/09/FordMustangGT4-feature-350x197.jpg"
  },
  {
    name: "Aston Martin Vantage GT4",
    cls: "GT4",
    tags: ["gt4", "balanced", "stable", "endurance", "user_friendly", "all_rounder"],
    img: "https://s100.iracing.com/wp-content/uploads/2022/03/Aston-Martin-Vantage-GT4-1-350x197.jpg"
  },
  {
    name: "BMW M4 G82 GT4 Evo",
    cls: "GT4",
    tags: ["gt4", "modern", "front_engine", "stable", "gt3_transition", "meta_candidate"],
    img: "https://s100.iracing.com/wp-content/uploads/2024/09/bmw-m4-g82-gt4-feature-350x197.jpg"
  },
  {
    name: "McLaren 570S GT4",
    cls: "GT4",
    tags: ["gt4", "mid_engine", "nimble", "rotation", "oversteer_prone", "fun"],
    img: "https://s100.iracing.com/wp-content/uploads/2021/03/McLaren-570s-GT4-350x197.jpg"
  },
  {
    name: "Mercedes-AMG GT4",
    cls: "GT4",
    tags: ["gt4", "front_mid_engine", "safe", "beginner_friendly", "braking_confidence"],
    img: "https://s100.iracing.com/wp-content/uploads/2022/05/Mercedes-AMG-GT4-350x197.jpg"
  },
  {
    name: "Porsche 718 Cayman GT4 Clubsport",
    cls: "GT4",
    tags: ["gt4", "mid_engine", "precise", "rotation", "trail_brake", "drivers_car"],
    img: "https://s100.iracing.com/wp-content/uploads/2020/04/Porsche-718-Cayman-GT4-Clubsport-feature-350x197.jpg"
  },
  {
    name: "BMW M4 F82 GT4 â€“ 2018",
    cls: "GT4",
    tags: ["gt4", "legacy", "front_engine", "stable", "club_racing", "old_meta"],
    img: "https://s100.iracing.com/wp-content/uploads/2020/06/BMW-M4-GT4-350x197.jpg"
  },

  {
    name: "Ferrari 296 Challenge",
    cls: "Cup",
    tags: ["cup", "single_make", "high_power", "gt3_like", "late_braker", "aggressive"],
    img: "https://s100.iracing.com/wp-content/uploads/2025/06/Ferrari296Challenge-feature-350x197.jpg"
  },
  {
    name: "Porsche 911 GT3 Cup (992)",
    cls: "Cup",
    tags: ["cup", "single_make", "rear_engine", "no_abs", "hard_braking", "high_skill"],
    img: "https://s100.iracing.com/wp-content/uploads/2021/08/porsche992Cup-feature-350x197.jpg"
  },
  {
    name: "Porsche 911 GT3 Cup",
    cls: "Cup",
    tags: ["cup", "legacy", "rear_engine", "knife_edge", "trail_brake", "purist"],
    img: "https://s100.iracing.com/wp-content/uploads/2017/01/Porsche-911-Cup-991-350x197.jpg"
  },
  {
    name: "BMW M2 CS Racing",
    cls: "Cup",
    tags: ["cup", "front_engine", "stable", "beginner_friendly", "sprint", "door_to_door"],
    img: "https://s100.iracing.com/wp-content/uploads/2024/12/bmw-m2-csr-feature-350x197.jpg"
  },

  // =========================
  // TCR & íˆ¬ì–´ë§ / ìŠ¤í†¡ì¹´ ë¸Œë¼ì§ˆ
  // =========================
  {
    name: "Audi RS 3 LMS TCR",
    cls: "TCR",
    tags: ["tcr", "fwd", "late_braker", "aggressive", "curb_attack", "touring"],
    img: "https://s100.iracing.com/wp-content/uploads/2019/09/Audi-RS3-LMS-GT4-350x197.jpg"
  },
  {
    name: "Hyundai Elantra N TCR",
    cls: "TCR",
    tags: ["tcr", "fwd", "meta", "stable", "brake_trust", "front_grip"],
    img: "https://s100.iracing.com/wp-content/uploads/2021/12/hyundai-tile-350x197.jpg"
  },
  {
    name: "Hyundai Veloster N TCR",
    cls: "TCR",
    tags: ["tcr", "fwd", "nimble", "rotation_on_brake", "lively", "fun"],
    img: "https://s100.iracing.com/wp-content/uploads/2022/03/Hyundai-Elantra-N-350x197.jpg"
  },
  {
    name: "Honda Civic Type R TCR",
    cls: "TCR",
    tags: ["tcr", "fwd", "balanced", "well_known", "late_braker", "touring"],
    img: "https://s100.iracing.com/wp-content/uploads/2021/12/honda-tile-350x197.jpg"
  },

  {
    name: "Stockcar Brasil Chevrolet Cruze",
    cls: "Stockcar",
    tags: ["stockcar", "brazil", "door_to_door", "aggressive", "high_downforce_tin_top"],
    img: "https://s100.iracing.com/wp-content/uploads/2022/03/Stock-Car-Brasil-Chevrolet-Cruze-1-350x197.jpg"
  },
  {
    name: "Stockcar Brasil Toyota Corolla",
    cls: "Stockcar",
    tags: ["stockcar", "brazil", "touring_style", "contact_prone", "push_to_pass"],
    img: "https://s100.iracing.com/wp-content/uploads/2022/03/Stock-Car-Brasil-Toyota-Corolla-1-350x197.jpg"
  },

  // =========================
  // GTE & GT1 / GTLM
  // =========================
  {
    name: "BMW M8 GTE",
    cls: "GTE",
    tags: ["gte", "front_engine", "big_body", "stable", "torque", "endurance"],
    img: "https://s100.iracing.com/wp-content/uploads/2019/02/BMW-M8-GT3-350x197.jpg"
  },
  {
    name: "Chevrolet Corvette C8.R",
    cls: "GTE",
    tags: ["gte", "mid_engine", "modern", "downforce", "aggressive", "sound_enjoyer"],
    img: "https://s100.iracing.com/wp-content/uploads/2020/09/Chevrolet_Corvette_C8R-350x197.jpg"
  },
  {
    name: "Ferrari 488 GTE",
    cls: "GTE",
    tags: ["gte", "mid_engine", "balanced", "classic_endurance", "meta_memory"],
    img: "https://s100.iracing.com/wp-content/uploads/2017/06/Ferrari-488-GTE-2-350x197.jpg"
  },
  {
    name: "Ford GT GTE",
    cls: "GTE",
    tags: ["gte", "mid_engine", "old_school", "raw", "challenging"],
    img: "https://s100.iracing.com/wp-content/uploads/2017/06/Ford-GT-2017-350x197.jpg"
  },
  {
    name: "Porsche 911 RSR",
    cls: "GTE",
    tags: ["gte", "rear_engine_like", "screamer_sound", "rotation", "high_skill", "fan_favorite"],
    img: "https://s100.iracing.com/wp-content/uploads/2018/06/Porsche-991-RSR-GTE-feature-350x197.jpg"
  },

  {
    name: "Chevrolet Corvette C6.R",
    cls: "GT1",
    tags: ["gt1", "brutal", "high_power", "old_school", "loud", "endurance_legend"],
    img: "https://s100.iracing.com/wp-content/uploads/2012/11/Corvette-C6R-350x197.jpg"
  },
  {
    name: "Aston Martin DBR9 GT1",
    cls: "GT1",
    tags: ["gt1", "v12", "iconic", "high_speed", "raw", "aero_car"],
    img: "https://s100.iracing.com/wp-content/uploads/2015/05/Aston-Martin-350x197.jpg"
  },

  // =========================
  // ìŠˆí¼ì¹´ / V8 ìŠˆí¼ì¹´
  // =========================
  {
    name: "Supercars Chevrolet Camaro Gen 3",
    cls: "Supercars",
    tags: ["supercars", "v8", "australia", "heavy", "sliding", "aggressive"],
    img: "https://s100.iracing.com/wp-content/uploads/2024/12/supercars-camaro-gen3-feature-350x197.jpg"
  },
  {
    name: "Supercars Ford Mustang Gen 3",
    cls: "Supercars",
    tags: ["supercars", "v8", "australia", "late_braker", "busy_rear", "fun"],
    img: "https://s100.iracing.com/wp-content/uploads/2024/12/supercars-mustang-gen3-feature-350x197.jpg"
  },
  {
    name: "Supercars Ford Mustang GT",
    cls: "Supercars",
    tags: ["supercars", "legacy", "v8", "slidey", "technical", "enduro_sprint"],
    img: "https://s100.iracing.com/wp-content/uploads/2019/12/New-Ford-Tile-350x197.jpg"
  },
  {
    name: "Supercars Holden ZB Commodore",
    cls: "Supercars",
    tags: ["supercars", "v8", "holden", "door_to_door", "oversteer", "fan_favorite"],
    img: "https://s100.iracing.com/wp-content/uploads/2019/12/New-Holden-Tile-350x197.jpg"
  },
  {
    name: "V8 Supercar Holden VF Commodore â€“ 2014",
    cls: "Supercars",
    tags: ["supercars", "legacy", "v8", "old_regulations", "raw", "slidey"],
    img: "https://s100.iracing.com/wp-content/uploads/2013/12/Legacy-V8-Supercar-Holden-VF-Commodore-2014-feature-1-350x197.jpg"
  },
  {
    name: "V8 Supercar Ford FG Falcon â€“ 2014",
    cls: "Supercars",
    tags: ["supercars", "legacy", "v8", "ford_vs_holden", "lively", "challenging"],
    img: "https://s100.iracing.com/wp-content/uploads/2015/05/V8-Supercar-Ford-FG-Falcon-2014-feature-1-350x197.jpg"
  },
  {
    name: "V8 Supercar Ford Falcon â€“ 2009",
    cls: "Supercars",
    tags: ["supercars", "legacy", "v8", "historic", "slide_monster"],
    img: "https://s100.iracing.com/wp-content/uploads/2020/05/legacy_V8SupercarFordFalcon_2009-350x197.jpg"
  },

  // =========================
  // ë ˆê±°ì‹œ íˆ¬ì–´ë§ / ìŠ¤íŠ¸ë¦¬íŠ¸ ê³„ì—´
  // =========================
  {
    name: "Cadillac CTS-V",
    cls: "Touring",
    tags: ["touring", "v8_sedan", "heavy", "club_racing", "brake_management"],
    img: "https://s100.iracing.com/wp-content/uploads/2020/05/included_CadillacCTS-V-350x197.jpg"
  },
  {
    name: "Kia Optima",
    cls: "Touring",
    tags: ["touring", "fwd", "turbo", "late_braker", "curb_attack", "legacy_series"],
    img: "https://s100.iracing.com/wp-content/uploads/2013/04/included_Kia_Optima-350x197.jpg"
  },
  {
    name: "Ford Mustang FR500S",
    cls: "Touring",
    tags: ["touring", "front_engine", "spec_series", "hpde_style", "entry_level"],
    img: "https://s100.iracing.com/wp-content/uploads/2012/11/Ford-FR500-350x197.jpg"
  },
  {
    name: "Renault Clio R.S. V",
    cls: "Touring",
    tags: ["touring", "fwd", "momentum", "short_track", "close_racing"],
    img: "https://s100.iracing.com/wp-content/uploads/2023/03/renaultclio-feature-350x197.jpg"
  },
  {
    name: "Ruf Rt 12 R",
    cls: "Sports",
    tags: ["sports", "rear_engine", "street_based", "oversteer_prone", "sound", "hero_laps"],
    img: "https://s100.iracing.com/wp-content/uploads/2013/01/Ruf-RT12-350x197.jpg"
  },
  {
    name: "Volkswagen Jetta TDi",
    cls: "Touring",
    tags: ["touring", "diesel", "momentum", "low_power", "rookie_friendly"],
    img: "https://s100.iracing.com/wp-content/uploads/2012/11/included_VWJettaTDI-350x197.jpg"
  },

  // =========================
  // MX-5 / Solstice / GR86 ê³„ì—´
  // =========================
  {
    name: "Toyota GR86",
    cls: "Club",
    tags: ["club", "rwd", "momentum", "beginner_friendly", "drift_vibes", "slow_in_fast_out"],
    img: "https://s100.iracing.com/wp-content/uploads/2022/12/Toyota-GR86-350x197.jpg"
  },
  {
    name: "Global Mazda MX-5 Cup",
    cls: "Club",
    tags: ["club", "mx5", "spec_series", "rookie_step", "momentum", "door_to_door"],
    img: "https://s100.iracing.com/wp-content/uploads/2015/05/Global-Mazda-MX-5-Feature-350x197.jpg"
  },
  {
    name: "Mazda MX-5 Cup â€“ 2010",
    cls: "Club",
    tags: ["club", "mx5", "legacy", "momentum", "learning", "safe"],
    img: "https://s100.iracing.com/wp-content/uploads/2025/07/mazda-mx-5-cup-2010-feature-350x197.jpg"
  },
  {
    name: "Mazda MX-5 Roadster â€“ 2010",
    cls: "Club",
    tags: ["club", "mx5", "roadster", "training", "slow_car_fast", "rookie"],
    img: "https://s100.iracing.com/wp-content/uploads/2025/07/mazda-mx-5-roadster-2010-feature-350x197.jpg"
  },
  {
    name: "Pontiac Solstice Club Sport",
    cls: "Club",
    tags: ["club", "legacy", "slow", "momentum", "old_rookie", "teaching"],
    img: "https://s100.iracing.com/wp-content/uploads/2012/10/PontiacSolstice-feature-350x197.jpg"
  },
  {
    name: "Pontiac Solstice Club Sport â€“ Rookie",
    cls: "Club",
    tags: ["club", "rookie", "slow", "safe", "training", "beginner"],
    img: "https://s100.iracing.com/wp-content/uploads/2012/10/PontiacSolstice_Rookie-feature-350x197.jpg"
  },

  // =========================
  // GTP / LMDh / LMP / DP / í”„ë¡œí† 
  // =========================
  {
    name: "Ferrari 499P",
    cls: "GTP",
    tags: ["gtp", "hypercar", "hybrid", "high_downforce", "endurance", "meta_candidate"],
    img: "https://s100.iracing.com/wp-content/uploads/2024/12/ferrari-499p-feature-350x197.jpg"
  },
  {
    name: "Acura ARX-06 GTP",
    cls: "GTP",
    tags: ["gtp", "hybrid", "nimble", "rotation", "high_skill", "imsa"],
    img: "https://s100.iracing.com/wp-content/uploads/2023/09/HRCAcuraARX-06-feature-350x197.jpg"
  },
  {
    name: "Porsche 963 GTP",
    cls: "GTP",
    tags: ["gtp", "hybrid", "high_tech", "endurance", "porsche_fan", "oval_plus_road"],
    img: "https://s100.iracing.com/wp-content/uploads/2023/09/Porsche963GTP-feature-1-350x197.jpg"
  },
  {
    name: "Cadillac V-Series.R GTP",
    cls: "GTP",
    tags: ["gtp", "hybrid", "american", "torquey", "stable", "endurance"],
    img: "https://s100.iracing.com/wp-content/uploads/2023/06/cadillacvgtp-feature-350x197.jpg"
  },
  {
    name: "BMW M Hybrid V8",
    cls: "GTP",
    tags: ["gtp", "hybrid", "bmw", "aggressive", "aero_sensitive", "high_ceiling"],
    img: "https://s100.iracing.com/wp-content/uploads/2022/12/BMW-M-Hybrid-V8-9-350x197.jpg"
  },
  {
    name: "Ligier JS P320",
    cls: "LMP3",
    tags: ["lmp3", "prototype", "entry_proto", "gt4_multi", "momentum", "training_proto"],
    img: "https://s100.iracing.com/wp-content/uploads/2023/06/Ligier-JS-P320-Feature-350x197.jpg"
  },
  {
    name: "Dallara P217 LMP2",
    cls: "LMP2",
    tags: ["lmp2", "prototype", "high_downforce", "multi_class", "endurance", "high_speed"],
    img: "https://s100.iracing.com/wp-content/uploads/2020/08/Dallara_P217_LMP2-1-350x197.jpg"
  },
  {
    name: "Porsche 919 LMP1",
    cls: "LMP1",
    tags: ["lmp1", "hybrid", "high_complexity", "ers_management", "very_fast", "hard"],
    img: "https://s100.iracing.com/wp-content/uploads/2018/02/Porsche-919-feature-350x197.jpg"
  },
  {
    name: "Audi R18 LMP1",
    cls: "LMP1",
    tags: ["lmp1", "diesel_era", "aero", "energy_management", "historic_lemans"],
    img: "https://s100.iracing.com/wp-content/uploads/2018/02/Audi-R18-1-350x197.jpg"
  },
  {
    name: "Chevrolet Corvette C7 Daytona Prototype",
    cls: "DP",
    tags: ["dp", "prototype", "rolex24_era", "brutal", "high_speed_oval", "raw"],
    img: "https://s100.iracing.com/wp-content/uploads/2015/09/C7-Corvette-DP-350x197.jpg"
  },
  {
    name: "HPD ARX 01c",
    cls: "LMP2",
    tags: ["lmp2", "legacy", "high_rev", "aero", "old_endurance", "challenging"],
    img: "https://s100.iracing.com/wp-content/uploads/2012/11/HRC-ARX01c-feature-350x197.jpg"
  },
  {
    name: "Riley Mk XX Daytona Prototype",
    cls: "DP",
    tags: ["dp", "legacy", "american_proto", "brutal", "oval_plus_road"],
    img: "https://s100.iracing.com/wp-content/uploads/2020/05/legacy_RileyMkXXDaytonaProto_2008-350x197.jpg"
  },
  {
    name: "Nissan GTP ZX-T",
    cls: "GTP_Legacy",
    tags: ["gtp", "turbo_era", "insane_speed", "turbo_lag", "old_school", "hero_or_zero"],
    img: "https://s100.iracing.com/wp-content/uploads/2016/09/Nissan-GTP-350x197.jpg"
  },
  {
    name: "Radical SR10",
    cls: "Radical",
    tags: ["radical", "high_downforce", "fast_club", "trackday_weapon", "precision"],
    img: "https://s100.iracing.com/wp-content/uploads/2022/05/Radical-SR10-350x197.jpg"
  },
  {
    name: "Radical SR8 V8",
    cls: "Radical",
    tags: ["radical", "legacy", "v8", "screamer", "lightweight", "high_skill"],
    img: "https://s100.iracing.com/wp-content/uploads/2020/05/included_RadicalSR8V8-350x197.jpg"
  },

  // =========================
  // ê¸°íƒ€ ìŠ¤í˜ì…œí‹° / ë¯¸ì…˜ R / GTO ë“±
  // =========================
  {
    name: "Porsche Mission R",
    cls: "EV_Cup",
    tags: ["ev", "cup", "electric", "insane_accel", "time_attack", "high_downforce"],
    img: "https://s100.iracing.com/wp-content/uploads/2022/09/Porsche-Mission-R-350x197.jpg"
  },
  {
    name: "Audi 90 GTO",
    cls: "GTO",
    tags: ["gto", "turbo", "group_b_vibes", "monster", "historic", "crowd_favorite"],
    img: "https://s100.iracing.com/wp-content/uploads/2016/09/Audi-90-GTO-350x197.jpg"
  },
  {
    name: "SCCA Spec Racer Ford",
    cls: "Spec",
    tags: ["spec", "club", "momentum", "teaching_racecraft", "low_power", "rookie_to_c"],
    img: "https://s100.iracing.com/wp-content/uploads/2020/05/included_SCCASpecRacerFord-350x197.jpg"
  }
];
    // ë°ëª¨ë¥¼ ìœ„í•´, ë§Œì•½ baseCarsê°€ ì „ì—­ì— ì—†ë‹¤ë©´ ê°„ë‹¨í•œ ìµœì†Œ ë”ë¯¸ë¼ë„ ë§Œë“¤ì–´ì„œ ì—ëŸ¬ ë°©ì§€
    if (typeof baseCars === "undefined") {
      console.warn("âš  baseCars ìƒìˆ˜ê°€ ì •ì˜ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤. ì‹¤ì œ ì‚¬ìš© ì‹œ, ì´ íŒŒì¼ ì•ˆì— baseCars ì „ì²´ë¥¼ ë¶™ì—¬ ë„£ìœ¼ì„¸ìš”.");
      window.baseCars = [
        {
          name: "Ferrari 296 GT3",
          cls: "GT3",
          tags: ["gt3", "modern", "mid_engine", "meta"],
          img: "https://s100.iracing.com/wp-content/uploads/2023/09/Ferrari296GT3-feature-1-350x197.jpg"
        },
        {
          name: "BMW M4 GT3 EVO",
          cls: "GT3",
          tags: ["gt3", "modern", "front_engine", "stable"],
          img: "https://s100.iracing.com/wp-content/uploads/2020/12/BMW-M4-GT3-Evo-feature-350x197.jpg"
        },
        {
          name: "Porsche 911 GT3 R (992)",
          cls: "GT3",
          tags: ["gt3", "modern", "rear_engine", "high_skill"],
          img: "https://s100.iracing.com/wp-content/uploads/2023/06/porsche992rgt3-feature-1-350x197.jpg"
        },
        {
          name: "Toyota GR86",
          cls: "Club",
          tags: ["club", "rwd", "beginner_friendly"],
          img: "https://s100.iracing.com/wp-content/uploads/2022/12/Toyota-GR86-350x197.jpg"
        }
      ];
    }

    // ===============================
    // 3. ìƒíƒœ ê´€ë¦¬
    // ===============================
    let currentStep = 1;
    let selectedLicense = null;
    let worldcupState = null; // ë¸Œë¼ì¼“ ìƒíƒœ
    let finalResult = null;   // ê³µìœ ë¥¼ ìœ„í•´ ì§ë ¬í™”í•  ìµœì¢… ê²°ê³¼

    // ===============================
    // 4. STEP ì „í™˜
    // ===============================
    function setStep(step) {
      currentStep = step;
      document.querySelectorAll(".step").forEach(s => s.classList.remove("active"));
      document.getElementById("step" + step).classList.add("active");

      const nav1 = document.getElementById("navStep1");
      const nav2 = document.getElementById("navStep2");
      const nav3 = document.getElementById("navStep3");
      [nav1, nav2, nav3].forEach(n => {
        n.classList.remove("active", "done");
      });
      nav1.classList.add(step === 1 ? "active" : (step > 1 ? "done" : ""));
      nav2.classList.add(step === 2 ? "active" : (step > 2 ? "done" : (step > 1 ? "done" : "")));
      nav3.classList.add(step === 3 ? "active" : (step > 3 ? "done" : ""));
    }

    // ===============================
    // 5. STEP 1 â€“ ë¼ì´ì„¼ìŠ¤ ë Œë”ë§
    // ===============================
    function renderLicenseCards() {
      const grid = document.getElementById("licenseGrid");
      grid.innerHTML = "";
      licenseOptions.forEach(opt => {
        const div = document.createElement("div");
        div.className = "license-card";
        div.dataset.id = opt.id;
        div.innerHTML = `
          <div class="license-badge">${opt.id}</div>
          <div class="license-title">${opt.title}</div>
          <div class="license-desc">${opt.desc}</div>
          <div class="license-meta">${opt.detail}</div>
        `;
        div.addEventListener("click", () => {
          selectedLicense = opt;
          document.querySelectorAll(".license-card").forEach(c => c.classList.remove("selected"));
          div.classList.add("selected");
          document.getElementById("toStep2").disabled = false;
        });
        grid.appendChild(div);
      });
    }

    // ===============================
    // 6. STEP 2 â€“ ì›”ë“œì»µ ë¡œì§
    // ===============================
    function shuffle(array) {
      const arr = array.slice();
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    function roundName(size) {
      if (size === 32) return "32ê°•";
      if (size === 16) return "16ê°•";
      if (size === 8) return "8ê°•";
      if (size === 4) return "4ê°•";
      if (size === 2) return "ê²°ìŠ¹";
      return "ìš°ìŠ¹";
    }

    function initWorldcup() {
      const initialSize = Math.min(32, baseCars.length); // ìµœëŒ€ 32ê°•
      const shuffled = shuffle(baseCars);
      const first = shuffled.slice(0, initialSize);

      worldcupState = {
        initialSize,
        currentRound: first,
        nextRound: [],
        index: 0,
        roundNumber: 1,
        winner: null
      };
      renderMatch();
    }

    function renderMatch() {
      const roundInfoEl = document.getElementById("roundInfo");
      const matchGridEl = document.getElementById("matchGrid");
      const roundProgEl = document.getElementById("roundProgress");

      if (!worldcupState) {
        roundInfoEl.textContent = "ì›”ë“œì»µ ì„¤ì • ì˜¤ë¥˜ (baseCars í™•ì¸ í•„ìš”)";
        matchGridEl.innerHTML = "";
        roundProgEl.textContent = "";
        return;
      }

      const { currentRound, index, initialSize } = worldcupState;

      // ìš°ìŠ¹ í™•ì •
      if (currentRound.length === 1) {
        const w = currentRound[0];
        worldcupState.winner = w;
        roundInfoEl.textContent = `ìš°ìŠ¹ â€“ ${w.name}`;
        matchGridEl.innerHTML = "";
        roundProgEl.textContent = "ìš°ì¸¡ 3ë‹¨ê³„ì—ì„œ ìƒì„¸ ê²°ê³¼ì™€ ìœ ë£Œ ë¹„ìš©, ê³µìœ  ë§í¬ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.";
        // ë°”ë¡œ ê²°ê³¼ ë‹¨ê³„ë¡œ
        buildFinalResultAndRender();
        setStep(3);
        return;
      }

      // í˜„ì¬ ë¼ìš´ë“œ ì •ë³´
      const rn = roundName(currentRound.length);
      const totalPairs = currentRound.length / 2;
      const currentPair = Math.floor(index / 2) + 1;
      roundInfoEl.textContent = `${rn} â€“ ë§¤ì¹˜ ${currentPair} / ${totalPairs}`;

      // í˜„ì¬ ë§¤ì¹˜ì—…
      const carA = currentRound[index];
      const carB = currentRound[index + 1];

      matchGridEl.innerHTML = `
        ${renderCarCardHTML(carA, "left")}
        ${renderCarCardHTML(carB, "right")}
      `;

      // í´ë¦­ í•¸ë“¤ëŸ¬
      const leftCard = document.querySelector('.car-card[data-pos="left"]');
      const rightCard = document.querySelector('.car-card[data-pos="right"]');

      leftCard.onclick = () => chooseWinner(carA);
      rightCard.onclick = () => chooseWinner(carB);

      roundProgEl.textContent = `í•œ ë§¤ì¹˜ì—ì„œ ê°™ì€ ì°¨ê°€ ì¢Œ/ìš° ì¤‘ë³µë˜ì§€ ì•Šë„ë¡ ê³ ì •ëœ ëŒ€ì§„ì„ ì‚¬ìš©í•œë‹¤. ì„ íƒí•œ ì°¨ë§Œ ë‹¤ìŒ ë¼ìš´ë“œë¡œ ì§„ì¶œ.`;
    }

    function renderCarCardHTML(car, pos) {
      const tags = (car.tags || []).slice(0, 6).map(t => `<span class="tag">#${t}</span>`).join("");
      const safeImg = car.img || "";
      return `
        <div class="car-card" data-pos="${pos}">
          <div class="car-image-wrap">
            ${safeImg ? `<img src="${safeImg}" alt="${car.name} ì´ë¯¸ì§€" loading="lazy" />` : ""}
          </div>
          <div class="car-content">
            <div class="car-name">${car.name}</div>
            <div class="car-class">${car.cls || ""}</div>
            <div class="car-tags">${tags}</div>
          </div>
        </div>
      `;
    }

    function chooseWinner(car) {
      if (!worldcupState) return;
      worldcupState.nextRound.push(car);
      worldcupState.index += 2;

      // ë¼ìš´ë“œ ë
      if (worldcupState.index >= worldcupState.currentRound.length) {
        worldcupState.currentRound = worldcupState.nextRound;
        worldcupState.nextRound = [];
        worldcupState.index = 0;
        worldcupState.roundNumber += 1;
      }
      renderMatch();
    }

    // ===============================
    // 7. STEP 3 â€“ ë¹„ìš© ê³„ì‚° + ê²°ê³¼ ìƒì„±
    // ===============================
    function computeCostSummary(winnerCar) {
      // Bí´ë˜ìŠ¤ ê¸°ì¤€ GT3 ì‹œë¦¬ì¦ˆ 1ê°œ í’€ ì‹œì¦Œ ê°€ì •.
      const CAR_PRICE = 11.95;      // ì°¨ëŸ‰ 1ëŒ€
      const TRACK_PRICE = 14.95;    // íŠ¸ë™ 1ê°œ
      const TRACK_COUNT = 11;       // 12ì£¼ ì¤‘ 1~2ì£¼ íœ´ì‹/ìŠ¤í‚µ ê°ì•ˆ
      const DISCOUNT_RATE = 0.15;   // 6ê°œ ì´ìƒ êµ¬ë§¤ í• ì¸ ê°€ì •
      const DISCOUNT_THRESHOLD = 6;

      const carCount = 1;
      const trackCount = TRACK_COUNT;

      const carCost = CAR_PRICE * carCount;
      const trackCost = TRACK_PRICE * trackCount;
      const total = carCost + trackCost;

      let discountedTotal = total;
      const itemCountForDiscount = carCount + trackCount;
      if (itemCountForDiscount >= DISCOUNT_THRESHOLD) {
        discountedTotal = total * (1 - DISCOUNT_RATE);
      }

      return {
        winnerName: winnerCar ? winnerCar.name : null,
        carCost,
        trackCost,
        total,
        discountedTotal,
        assumptions: {
          carCount,
          trackCount,
          carPriceEach: CAR_PRICE,
          trackPriceEach: TRACK_PRICE,
          discountRate: DISCOUNT_RATE,
          discountThreshold: DISCOUNT_THRESHOLD
        }
      };
    }

    function buildFinalResultAndRender() {
      // ì¸í„°ë™í‹°ë¸Œ ëª¨ë“œì—ì„œ í˜¸ì¶œ (ë¼ì´ì„¼ìŠ¤ + ì›”ë“œì»µ + ë¹„ìš© ì‚¼ë°•ì)
      const winner = worldcupState ? worldcupState.winner : null;

      const cost = computeCostSummary(winner || baseCars[0]);

      finalResult = {
        version: "1",
        license: selectedLicense ? selectedLicense.id : null,
        licenseTitle: selectedLicense ? selectedLicense.title : null,
        licenseDesc: selectedLicense ? selectedLicense.desc : null,
        licenseDetail: selectedLicense ? selectedLicense.detail : null,
        winner: winner
          ? {
              name: winner.name,
              cls: winner.cls,
              tags: winner.tags || [],
              img: winner.img || ""
            }
          : null,
        cost
      };

      renderResultPanels(finalResult);
      buildShareLink(finalResult);
    }

    function renderResultPanels(result) {
      const licEl = document.getElementById("licenseResultBody");
      const wcEl = document.getElementById("worldcupResultBody");
      const costEl = document.getElementById("costResultBody");

      // â‘  ë¼ì´ì„¼ìŠ¤
      if (result.license) {
        licEl.innerHTML = `
          <div class="summary-line">
            <span class="pill">
              <strong>${result.license}</strong> ë¼ì´ì„¼ìŠ¤ ì„±í–¥
            </span>
          </div>
          <div class="summary-line" style="margin-top:6px;">
            <strong>${result.licenseTitle}</strong>
          </div>
          <div class="summary-line">${result.licenseDesc}</div>
          <div class="summary-line small">${result.licenseDetail}</div>
        `;
      } else {
        licEl.innerHTML = `
          <div class="summary-line">
            ë¼ì´ì„¼ìŠ¤ë¥¼ ì„ íƒí•˜ì§€ ì•Šì•„ì„œ, ê¸°ë³¸ê°’ìœ¼ë¡œ ì²˜ë¦¬í–ˆë‹¤. (Dì„±í–¥ ë²”í¼ì¹´ ëŠë‚Œ)
          </div>
        `;
      }

      // â‘¡ ì›”ë“œì»µ ê²°ê³¼
      if (result.winner) {
        const w = result.winner;
        const tags = (w.tags || []).slice(0, 10).map(t => `<span class="tag">#${t}</span>`).join("");
        wcEl.innerHTML = `
          <div class="winner-badge">
            <span>ğŸ† ì´ìƒí˜• ì›”ë“œì»µ ìš°ìŠ¹</span>
          </div>
          <div class="car-card winner-highlight">
            <div class="car-image-wrap">
              ${w.img ? `<img src="${w.img}" alt="${w.name} ì´ë¯¸ì§€" />` : ""}
            </div>
            <div class="car-content">
              <div class="car-name">${w.name}</div>
              <div class="car-class">${w.cls || ""}</div>
              <div class="car-tags" style="margin-top:8px;">${tags}</div>
            </div>
          </div>
          <div class="summary-line small" style="margin-top:8px;">
            â€» ì´ ì¹´ë“œëŠ” â€˜ë‹¹ì‹ ì˜ í”Œë ˆì´ ìŠ¤íƒ€ì¼ë¡œ ì›”ë“œì»µ ëê¹Œì§€ ì‚´ì•„ë‚¨ì€ ì´ìƒí˜• ìŠ¤í¬ì¸ ì¹´â€™ë¥¼ ì˜ë¯¸í•œë‹¤.
          </div>
        `;
      } else {
        wcEl.innerHTML = `
          <div class="summary-line">
            ì›”ë“œì»µì„ ê±´ë„ˆë›°ì—ˆê¸° ë•Œë¬¸ì—, êµ¬ì²´ì ì¸ ìš°ìŠ¹ ì°¨ëŸ‰ ì •ë³´ëŠ” ë¹„ì–´ ìˆë‹¤.
          </div>
        `;
      }

      // â‘¢ ë¹„ìš© ìš”ì•½
      const c = result.cost;
      const rowsHtml = `
        <table class="cost-table">
          <tr>
            <th>í•­ëª©</th>
            <th class="num">ìˆ˜ëŸ‰ / ì¡°ê±´</th>
            <th class="num">ê¸ˆì•¡</th>
          </tr>
          <tr>
            <td>GT/í”„ë¡œí†  ì°¨ëŸ‰ ë¼ì´ì„¼ìŠ¤</td>
            <td class="num">${c.assumptions.carCount}ëŒ€ Ã— ${formatMoney(c.assumptions.carPriceEach)}</td>
            <td class="num">${formatMoney(c.carCost)}</td>
          </tr>
          <tr>
            <td>2025 S4 Bí´ë˜ìŠ¤ìš© ìœ ë£Œ íŠ¸ë™</td>
            <td class="num">${c.assumptions.trackCount}ê°œ Ã— ${formatMoney(c.assumptions.trackPriceEach)}</td>
            <td class="num">${formatMoney(c.trackCost)}</td>
          </tr>
          <tr>
            <td>ì •ê°€ í•©ê³„</td>
            <td class="num">ì°¨ëŸ‰ + íŠ¸ë™</td>
            <td class="num">${formatMoney(c.total)}</td>
          </tr>
          <tr>
            <td>6ê°œ ì´ìƒ ë¬¶ìŒ í• ì¸ ê°€ì •</td>
            <td class="num">ì•½ ${(c.assumptions.discountRate * 100).toFixed(0)}% í• ì¸</td>
            <td class="num">${formatMoney(c.discountedTotal)}</td>
          </tr>
        </table>
      `;

      costEl.innerHTML = `
        <div class="summary-line">
          <strong>B ë¼ì´ì„¼ìŠ¤ ê¸°ì¤€, GT3/ìŠ¤í¬ì¸ ì¹´ ì‹œì¦Œ í’€ì°¸ì—¬ë¥¼ ìœ„í•œ ìœ ë£Œ ê¸ˆì•¡ ëŒ€ëµì¹˜</strong>ë‹¤.
        </div>
        <div class="summary-line">
          <span class="pill">
            ê¸°ì¤€: GT/í”„ë¡œí†  ì°¨ëŸ‰ 1ëŒ€ + ìœ ë£Œ íŠ¸ë™ ${c.assumptions.trackCount}ê°œ
          </span>
        </div>
        ${rowsHtml}
        <div class="summary-line small" style="margin-top:6px;">
          ì‹¤ì œ ì§€ì¶œì€ ë³´ìœ  ì°¨ëŸ‰/íŠ¸ë™, ì„¸ì¼, ì‹œì¦Œë³„ ìŠ¤ì¼€ì¤„ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆë‹¤.  
          ì—¬ê¸°ì„œëŠ” <strong>2025 Season 4 Bí´ë˜ìŠ¤ ìŠ¤í¬ì¸ ì¹´</strong>ë¥¼ ì „ì œë¡œ í•œ, ì´í•´ë¥¼ ë•ê¸° ìœ„í•œ ì°¸ê³ ê°’ì´ë‹¤.
        </div>
      `;
    }

    // ===============================
    // 8. ê³µìœ  ë§í¬ ìƒì„± / ë¡œë”©
    // ===============================
    function buildShareLink(result) {
      const param = encodeResult(result);
      const url = new URL(window.location.href);
      url.searchParams.set("r", param);
      // ë‹¤ë¥¸ íŒŒë¼ë¯¸í„°ëŠ” ìœ ì§€í•˜ë˜ rë§Œ ì—…ë°ì´íŠ¸
      const shareUrl = url.toString();
      const input = document.getElementById("shareInput");
      input.value = shareUrl;
    }

    function loadSharedResultIfExists() {
      const params = new URLSearchParams(window.location.search);
      const r = params.get("r");
      if (!r) return false;

      const decoded = decodeResult(r);
      if (!decoded) return false;

      finalResult = decoded;
      renderResultPanels(finalResult);
      // ê³µìœ  URL ë‹¤ì‹œ ë§Œë“¤ì–´ì„œ ì…ë ¥ì°½ì— ê°±ì‹  (ê·¸ëŒ€ë¡œ ë³µì‚¬ ê°€ëŠ¥)
      buildShareLink(finalResult);

      // ë°°ë„ˆ
      const banner = document.getElementById("sharedBanner");
      banner.style.display = "block";
      banner.textContent = "ì´ í˜ì´ì§€ëŠ” ëˆ„êµ°ê°€ê°€ ì™„ë£Œí•œ ì„¤ë¬¸/ì›”ë“œì»µ ê²°ê³¼ë¥¼ ê³µìœ í•œ ë§í¬ì…ë‹ˆë‹¤. ìƒë‹¨ â€˜ì²˜ìŒë¶€í„° ë‹¤ì‹œ í•˜ê¸°â€™ë¥¼ ëˆŒëŸ¬ ë³¸ì¸ ê¸°ì¤€ìœ¼ë¡œ ë‹¤ì‹œ ì§„í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";

      // 3ë‹¨ê³„ë¡œ ë°”ë¡œ ì´ë™
      setStep(3);
      return true;
    }

    // ===============================
    // 9. ì´ë²¤íŠ¸ ë°”ì¸ë”© & ì´ˆê¸°í™”
    // ===============================
    document.addEventListener("DOMContentLoaded", () => {
      renderLicenseCards();

      // STEP1 â†’ STEP2
      document.getElementById("toStep2").addEventListener("click", () => {
        if (!selectedLicense) return;
        initWorldcup();
        setStep(2);
      });

      // STEP2 â† STEP1
      document.getElementById("backTo1").addEventListener("click", () => {
        setStep(1);
      });

      // STEP2: ì›”ë“œì»µ ê±´ë„ˆë›°ê¸° â†’ ë°”ë¡œ ê²°ê³¼ (ë¼ì´ì„¼ìŠ¤ + ë¹„ìš©ë§Œ)
      document.getElementById("skipToResult").addEventListener("click", () => {
        if (!selectedLicense) {
          alert("ë¨¼ì € 1ë‹¨ê³„ì—ì„œ ë¼ì´ì„¼ìŠ¤ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.");
          return;
        }
        // winner ì—†ì´ ë¹„ìš©ë§Œ
        const dummyWinner = baseCars[0];
        const cost = computeCostSummary(dummyWinner);
        finalResult = {
          version: "1",
          license: selectedLicense.id,
          licenseTitle: selectedLicense.title,
          licenseDesc: selectedLicense.desc,
          licenseDetail: selectedLicense.detail,
          winner: null,
          cost
        };
        renderResultPanels(finalResult);
        buildShareLink(finalResult);
        setStep(3);
      });

      // STEP3: ë³µì‚¬
      document.getElementById("copyShare").addEventListener("click", async () => {
        const input = document.getElementById("shareInput");
        input.select();
        input.setSelectionRange(0, 99999);
        try {
          if (navigator.clipboard && navigator.clipboard.writeText) {
            await navigator.clipboard.writeText(input.value);
          } else {
            document.execCommand("copy");
          }
          alert("ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.");
        } catch (e) {
          alert("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ ì„ íƒí•´ì„œ ë³µì‚¬í•´ ì£¼ì„¸ìš”.");
        }
      });

      // STEP3: ë‹¤ì‹œ ì‹œì‘
      document.getElementById("restartAll").addEventListener("click", () => {
        // URLì˜ r íŒŒë¼ë¯¸í„° ì œê±°
        const url = new URL(window.location.href);
        url.searchParams.delete("r");
        window.history.replaceState({}, "", url.toString());

        selectedLicense = null;
        worldcupState = null;
        finalResult = null;
        document.getElementById("sharedBanner").style.display = "none";
        document.getElementById("shareInput").value = "";
        document.getElementById("toStep2").disabled = true;
        document.querySelectorAll(".license-card").forEach(c => c.classList.remove("selected"));
        setStep(1);
      });

      // STEP3: ì›”ë“œì»µë§Œ ë‹¤ì‹œ
      document.getElementById("backTo2").addEventListener("click", () => {
        if (!selectedLicense) {
          alert("ë¨¼ì € 1ë‹¨ê³„ì—ì„œ ë¼ì´ì„¼ìŠ¤ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.");
          return;
        }
        initWorldcup();
        setStep(2);
      });

      // ì²˜ìŒ ë¡œë“œ ì‹œ, ê³µìœ  ë§í¬ì¸ì§€ ë¨¼ì € í™•ì¸
      const shared = loadSharedResultIfExists();
      if (!shared) {
        setStep(1);
      }
    });
  </script>
</body>
</html>
